<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>PokÃ©mon Village v2.0</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body { 
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            font-family: 'Courier New', monospace;
            color: #fff;
            overflow: hidden;
            padding: 10px;
        }

        #gameContainer {
            background: #0f3460;
            border: 4px solid #e94560;
            border-radius: 12px;
            box-shadow: 0 0 30px rgba(233, 69, 96, 0.5);
            padding: 15px;
            max-width: 800px;
            width: 100%;
        }

        #gameTitle {
            text-align: center;
            font-size: 24px;
            font-weight: bold;
            color: #ffcc00;
            text-shadow: 2px 2px 4px #000;
            margin-bottom: 10px;
            letter-spacing: 2px;
        }

        canvas { 
            display: block;
            border: 3px solid #533483;
            background: #d4a574;
            image-rendering: pixelated;
            image-rendering: crisp-edges;
            width: 100%;
            max-width: 640px;
            height: auto;
            margin: 0 auto 15px;
            box-shadow: inset 0 0 10px rgba(0,0,0,0.5);
        }

        #controls {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            background: #1a1a2e;
            padding: 15px;
            border-radius: 8px;
            max-width: 250px;
            margin: 0 auto;
        }

        .control-row {
            display: flex;
            gap: 5px;
        }

        .btn {
            width: 70px;
            height: 70px;
            background: linear-gradient(145deg, #e94560, #c23456);
            border: 3px solid #533483;
            border-radius: 10px;
            color: #fff;
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
            user-select: none;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.1s;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }

        .btn:active {
            transform: scale(0.95);
            box-shadow: 0 2px 3px rgba(0,0,0,0.4);
            background: linear-gradient(145deg, #c23456, #a02848);
        }

        .btn.empty {
            background: transparent;
            border: none;
            box-shadow: none;
            cursor: default;
        }

        .btn.interact {
            background: linear-gradient(145deg, #ffcc00, #e6b800);
            color: #000;
        }

        .btn.interact:active {
            background: linear-gradient(145deg, #e6b800, #cc9900);
        }

        #messageBox {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 90%;
            max-width: 600px;
            background: rgba(0, 0, 0, 0.95);
            border: 4px solid #ffcc00;
            border-radius: 12px;
            padding: 20px;
            color: #fff;
            font-size: 16px;
            text-align: center;
            display: none;
            z-index: 1000;
            box-shadow: 0 0 20px rgba(255, 204, 0, 0.6);
        }

        #messageBox.active {
            display: block;
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from { transform: translateX(-50%) translateY(20px); opacity: 0; }
            to { transform: translateX(-50%) translateY(0); opacity: 1; }
        }

        #stats {
            text-align: center;
            margin-top: 10px;
            font-size: 14px;
            color: #ffcc00;
        }

        @media (max-width: 600px) {
            #gameTitle { font-size: 18px; }
            .btn { width: 60px; height: 60px; font-size: 20px; }
            #messageBox { font-size: 14px; }
        }
    </style>
</head>
<body>
    <div id="gameContainer">
        <div id="gameTitle">âš¡ POKÃ‰MON VILLAGE âš¡</div>
        <canvas id="canvas"></canvas>
        <div id="controls">
            <div class="control-row">
                <div class="btn empty"></div>
                <div class="btn" data-dir="up">â–²</div>
                <div class="btn empty"></div>
            </div>
            <div class="control-row">
                <div class="btn" data-dir="left">â—„</div>
                <div class="btn interact" data-action="interact">A</div>
                <div class="btn" data-dir="right">â–º</div>
            </div>
            <div class="control-row">
                <div class="btn empty"></div>
                <div class="btn" data-dir="down">â–¼</div>
                <div class="btn empty"></div>
            </div>
        </div>
        <div id="stats">Items gefunden: <span id="itemCount">0</span>/3</div>
    </div>
    <div id="messageBox"></div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const messageBox = document.getElementById('messageBox');
        const itemCountEl = document.getElementById('itemCount');

        const TILE = 16;
        const SCALE = 2;
        const SIZE = TILE * SCALE;
        const COLS = 40;
        const ROWS = 30;

        canvas.width = COLS * SIZE;
        canvas.height = ROWS * SIZE;

        // Tile colors (PokÃ©mon Gold/Silver inspired)
        const COLORS = {
            grass: '#9cb870',
            path: '#d4a574',
            water: '#5884c8',
            tree: '#387038',
            treeDark: '#285828',
            roof: '#c84848',
            wall: '#e0c890',
            door: '#986048',
            window: '#70a8d8',
            fence: '#906030',
            flower: '#e84890',
            mart: '#4078c0',
            sign: '#c09050'
        };

        // Player
        const player = { x: 20, y: 25, color: '#f83838', items: 0 };

        // NPCs
        const npcs = [
            { x: 18, y: 10, color: '#4878d8', msg: 'ðŸ§‘ Trainer: Willkommen in Herbstdorf! Besuche das PokÃ©mon Center im Norden!' },
            { x: 25, y: 15, color: '#e89050', msg: 'ðŸ‘¨ Professor: Hast du schon die versteckten Items gefunden?' },
            { x: 30, y: 20, color: '#f878a8', msg: 'ðŸ‘§ Kind: Ich mÃ¶chte PokÃ©mon Trainer werden!' },
            { x: 12, y: 18, color: '#90c058', msg: 'ðŸ§“ Opa: Am Fluss gibt es oft seltene PokÃ©mon!' }
        ];

        // Wild PokÃ©mon (dekorativ)
        const pokemon = [
            { x: 8, y: 12, color: '#f8d030', name: 'âš¡' },
            { x: 35, y: 8, color: '#78c850', name: 'ðŸƒ' },
            { x: 15, y: 24, color: '#6890f0', name: 'ðŸ’§' }
        ];

        // Items
        const items = [
            { x: 10, y: 5, found: false, msg: 'âœ¨ Du hast einen Superball gefunden!' },
            { x: 38, y: 28, found: false, msg: 'â­ Du hast einen SternenstÃ¼ck gefunden!' },
            { x: 5, y: 20, found: false, msg: 'ðŸ’Ž Du hast einen Nugget gefunden!' }
        ];

        // Map (0=grass, 1=path, 2=tree, 3=water, 4=roof, 5=wall, 6=door, 7=fence, 8=flower, 9=mart, 10=sign)
        const map = Array(ROWS).fill(0).map(() => Array(COLS).fill(0));

        // Build map
        function buildMap() {
            // Fill with grass
            for(let y = 0; y < ROWS; y++) {
                for(let x = 0; x < COLS; x++) {
                    map[y][x] = 0;
                }
            }

            // Paths
            for(let y = 0; y < ROWS; y++) {
                for(let x = 15; x < 25; x++) map[y][x] = 1; // Main road
            }
            for(let x = 0; x < COLS; x++) {
                map[12][x] = 1; // Cross road
                map[20][x] = 1;
            }

            // River (water)
            for(let y = 0; y < ROWS; y++) {
                map[y][32] = 3;
                map[y][33] = 3;
            }

            // Trees border
            for(let x = 0; x < COLS; x++) {
                map[0][x] = 2;
                map[ROWS-1][x] = 2;
            }
            for(let y = 0; y < ROWS; y++) {
                map[y][0] = 2;
                map[y][COLS-1] = 2;
            }

            // PokÃ©mon Center (top)
            for(let y = 2; y < 7; y++) {
                for(let x = 17; x < 23; x++) {
                    if(y === 2) map[y][x] = 4; // Roof
                    else if(y === 6 && x === 20) map[y][x] = 6; // Door
                    else if(y > 2) map[y][x] = 5; // Wall
                }
            }

            // PokÃ© Mart (right side)
            for(let y = 8; y < 12; y++) {
                for(let x = 26; x < 30; x++) {
                    if(y === 8) map[y][x] = 9; // Mart roof
                    else if(y === 11 && x === 28) map[y][x] = 6; // Door
                    else if(y > 8) map[y][x] = 5;
                }
            }

            // Houses
            buildHouse(5, 15, 3, 3);
            buildHouse(10, 22, 4, 3);
            buildHouse(25, 8, 3, 3);

            // Decorations
            map[10][10] = 8; // Flower
            map[15][5] = 8;
            map[22][35] = 8;
            map[18][18] = 10; // Sign
        }

        function buildHouse(y, x, w, h) {
            for(let dy = 0; dy < h; dy++) {
                for(let dx = 0; dx < w; dx++) {
                    if(dy === 0) map[y+dy][x+dx] = 4; // Roof
                    else if(dy === h-1 && dx === Math.floor(w/2)) map[y+dy][x+dx] = 6; // Door
                    else if(dy > 0) map[y+dy][x+dx] = 5; // Wall
                }
            }
        }

        buildMap();

        const solid = [2, 3, 4, 5, 9]; // Collision tiles

        function drawTile(x, y, type) {
            const px = x * SIZE;
            const py = y * SIZE;

            switch(type) {
                case 0: ctx.fillStyle = COLORS.grass; break;
                case 1: ctx.fillStyle = COLORS.path; break;
                case 2: 
                    ctx.fillStyle = COLORS.tree;
                    ctx.fillRect(px, py, SIZE, SIZE);
                    ctx.fillStyle = COLORS.treeDark;
                    ctx.fillRect(px+4, py+4, SIZE-8, SIZE-8);
                    return;
                case 3: ctx.fillStyle = COLORS.water; break;
                case 4: ctx.fillStyle = COLORS.roof; break;
                case 5: 
                    ctx.fillStyle = COLORS.wall;
                    ctx.fillRect(px, py, SIZE, SIZE);
                    ctx.fillStyle = COLORS.window;
                    ctx.fillRect(px+8, py+8, 16, 12);
                    return;
                case 6: ctx.fillStyle = COLORS.door; break;
                case 7: ctx.fillStyle = COLORS.fence; break;
                case 8: 
                    ctx.fillStyle = COLORS.grass;
                    ctx.fillRect(px, py, SIZE, SIZE);
                    ctx.fillStyle = COLORS.flower;
                    ctx.fillRect(px+10, py+10, 12, 12);
                    return;
                case 9: ctx.fillStyle = COLORS.mart; break;
                case 10: ctx.fillStyle = COLORS.sign; break;
            }
            ctx.fillRect(px, py, SIZE, SIZE);
        }

        function draw() {
            // Draw map
            for(let y = 0; y < ROWS; y++) {
                for(let x = 0; x < COLS; x++) {
                    drawTile(x, y, map[y][x]);
                }
            }

            // Draw items
            items.forEach(item => {
                if(!item.found) {
                    ctx.fillStyle = '#ffd700';
                    ctx.fillRect(item.x * SIZE + 8, item.y * SIZE + 8, 16, 16);
                }
            });

            // Draw PokÃ©mon
            pokemon.forEach(p => {
                ctx.fillStyle = p.color;
                ctx.fillRect(p.x * SIZE + 4, p.y * SIZE + 4, SIZE-8, SIZE-8);
                ctx.fillStyle = '#000';
                ctx.font = '16px Arial';
                ctx.fillText(p.name, p.x * SIZE + 8, p.y * SIZE + 20);
            });

            // Draw NPCs
            npcs.forEach(npc => {
                ctx.fillStyle = npc.color;
                ctx.fillRect(npc.x * SIZE + 4, npc.y * SIZE + 4, SIZE-8, SIZE-8);
                ctx.fillStyle = '#fff';
                ctx.fillRect(npc.x * SIZE + 10, npc.y * SIZE + 10, 4, 4);
                ctx.fillRect(npc.x * SIZE + 18, npc.y * SIZE + 10, 4, 4);
            });

            // Draw player
            ctx.fillStyle = player.color;
            ctx.fillRect(player.x * SIZE + 2, player.y * SIZE + 2, SIZE-4, SIZE-4);
            ctx.fillStyle = '#fff';
            ctx.fillRect(player.x * SIZE + 8, player.y * SIZE + 8, 6, 6);
            ctx.fillRect(player.x * SIZE + 18, player.y * SIZE + 8, 6, 6);
        }

        let msgActive = false;

        function showMsg(text) {
            messageBox.textContent = text;
            messageBox.classList.add('active');
            msgActive = true;
        }

        function hideMsg() {
            messageBox.classList.remove('active');
            msgActive = false;
        }

        function interact() {
            if(msgActive) {
                hideMsg();
                return;
            }

            // Check items
            const item = items.find(i => i.x === player.x && i.y === player.y && !i.found);
            if(item) {
                item.found = true;
                player.items++;
                itemCountEl.textContent = player.items;
                showMsg(item.msg);
                draw();
                return;
            }

            // Check NPCs (adjacent)
            const dirs = [{x:0,y:-1}, {x:0,y:1}, {x:-1,y:0}, {x:1,y:0}];
            for(let dir of dirs) {
                const npc = npcs.find(n => n.x === player.x + dir.x && n.y === player.y + dir.y);
                if(npc) {
                    showMsg(npc.msg);
                    return;
                }
            }

            // Check PokÃ©mon
            for(let dir of dirs) {
                const poke = pokemon.find(p => p.x === player.x + dir.x && p.y === player.y + dir.y);
                if(poke) {
                    showMsg(`${poke.name} Ein wildes PokÃ©mon! Es scheint friedlich zu sein.`);
                    return;
                }
            }

            // Check special buildings
            if(player.y >= 2 && player.y <= 6 && player.x >= 17 && player.x <= 22) {
                showMsg('ðŸ’Š PokÃ©mon Center: Deine PokÃ©mon wurden geheilt!');
                return;
            }
            if(player.y >= 8 && player.y <= 11 && player.x >= 26 && player.x <= 29) {
                showMsg('ðŸ›’ PokÃ© Mart: Willkommen! Hier gibt es PokÃ©bÃ¤lle und TrÃ¤nke!');
                return;
            }

            showMsg('ðŸ’¬ Hier gibt es nichts zu untersuchen.');
        }

        let moving = false;

        function move(dx, dy) {
            if(moving || msgActive) return;

            const nx = player.x + dx;
            const ny = player.y + dy;

            if(nx < 0 || nx >= COLS || ny < 0 || ny >= ROWS) return;
            if(solid.includes(map[ny][nx])) {
                showMsg('â›” Du kannst dort nicht hingehen!');
                return;
            }

            // Check NPC collision
            if(npcs.find(n => n.x === nx && n.y === ny)) return;
            if(pokemon.find(p => p.x === nx && p.y === ny)) return;

            moving = true;
            player.x = nx;
            player.y = ny;
            draw();

            setTimeout(() => moving = false, 150);
        }

        // Controls
        document.addEventListener('keydown', e => {
            if(msgActive && !['e','Enter',' '].includes(e.key)) {
                hideMsg();
                return;
            }

            switch(e.key) {
                case 'ArrowUp': case 'w': move(0, -1); break;
                case 'ArrowDown': case 's': move(0, 1); break;
                case 'ArrowLeft': case 'a': move(-1, 0); break;
                case 'ArrowRight': case 'd': move(1, 0); break;
                case 'e': case 'Enter': case ' ': interact(); break;
            }
        });

        document.querySelectorAll('.btn').forEach(btn => {
            btn.addEventListener('touchstart', e => {
                e.preventDefault();
                const dir = btn.dataset.dir;
                if(dir === 'up') move(0, -1);
                else if(dir === 'down') move(0, 1);
                else if(dir === 'left') move(-1, 0);
                else if(dir === 'right') move(1, 0);
                else if(btn.dataset.action === 'interact') interact();
            }, {passive: false});
        });

        // Initial draw
        draw();
        showMsg('ðŸŽ® Willkommen in Herbstdorf! Erkunde die Stadt und finde alle 3 versteckten Items!');
    </script>
</body>
</html>